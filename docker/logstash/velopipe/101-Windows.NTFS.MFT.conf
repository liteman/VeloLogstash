filter {
    if "velociraptor" in [tags] and [Artifact] == "Windows.NTFS.MFT" {

        # get the Createdx10 and Modifiedx10 values
        # add them to EventTime as an array
        ruby {
            code => '
                createdts = event.get("Createdx10")
                modifiedts = event.get("Modifiedx10")
                event.set("EventTime", [createdts, modifiedts])
            '
        }
        mutate => {
            update => { "IsForensicTime" => true }
        }

        # Split this record to two events, so we can
        # index on Created and Modified timestamps
        split => { field => 'EventTime'}

    }

    
}